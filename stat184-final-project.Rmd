---
title: "Final Project"
author: "Lydia Bednarczyk"
output: html_notebook
---
Front Matter:
```{r}
rm(list=ls())
library(readr)
library(tidyverse)
library(DataComputing)
library(ggplot2)
library(dplyr)
library(party)
```

Research Question: How do the family lives of high school students effect their socializing/drinking habits, and in turn their success and interest in school?

Data Access:

```{r}
math_table <- read_csv("student-mat.csv")
head(math_table)

por_table <- read_csv("student-por.csv")
head(por_table)

```

Data Wrangling:

```{r}
# Add variable that specifies what subject
math_table$subject <- "math"
por_table$subject <- "portuguese"

# Combine the two dataframes into one
joined <- 
  full_join(math_table ,por_table)

```

```{r}
# Finding the highest level of parent education
joined <-
joined %>%
  mutate(parentedu = ifelse(Medu>Fedu, Medu, Fedu))


```

```{r}
# Calculate overall grade and average weekly alcohol consumption level
joined <-
joined %>%
  mutate(grade = (G1+G2+G3)/3,
         avgalc = ((Dalc*5)+(Walc*2))/7) 

# Round overall grade and average weekly alcohol consumption level
joined <-
joined %>%
  mutate(avgalc = round(avgalc),
         grade = round(grade))
```

```{r}
# Create levels of "high" or "low" alcohol consumption
joined <-
joined %>%
  mutate(avgalc = gsub("1", "low", avgalc),
         avgalc = gsub("2", "low", avgalc),
         avgalc = gsub("3", "high", avgalc),
         avgalc = gsub("4", "high", avgalc),
         avgalc = gsub("5", "high", avgalc))



```

```{r}
# Filter out one individual with parentedu of 0
joined <-
joined %>%
  filter(parentedu == c("1", "2", "3", "4"))
```


```{r}
# Select variables to be used in analysis
GlyphReady <-
joined %>%
  select(school, sex, age, address, famsize, Pstatus, famsup, famrel, subject, grade, avgalc, parentedu)
```

```{r}
# Make machine learning model
model <- lm(grade ~ avgalc + parentedu + famrel + famsup, data = GlyphReady)

summary(model)
```

```{r}
GlyphReady %>%
  filter(parentedu == "0")
```



Data Visualizations:

Amount of low vs high alcohol consumption

```{r}
GlyphReady %>%
  ggplot(aes(x=avgalc)) +
  geom_bar()
```


Amount of low vs high alcohol consumption

```{r}
GlyphReady %>%
  ggplot(aes(x=age, fill=avgalc)) +
  geom_bar(position="dodge") 

  
```

Distribution of Parent Education level

```{r}
GlyphReady %>%
  ggplot(aes(x=parentedu)) +
  geom_bar()
```

Distribution of grades based on parent education
```{r}
GlyphReady %>%
  ggplot(aes(x=parentedu, y=grade)) +
  geom_boxplot(aes(group=parentedu)) +
  xlab("Parent Education Level") +
  ylab("Average Grade")
```



